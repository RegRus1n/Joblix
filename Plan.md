# План разработки системы симуляций

## Общая структура

### Ключевые особенности системы:

1. **В одном уровне может быть множество заданий**
2. **Система звёзд** — за правильные ответы даются звёзды (1-3 звезды)
3. **За неправильные ответы** — предложение повторить
4. **Ключ `forma`** — определяет тип сцены, по которому через if/else рендерится нужный компонент
5. **Ключ `template`** — определяет визуальный шаблон (расположение текста, заголовка, фото маскота, цветовую палитру)
6. **ID** — у каждой сцены есть уникальный идентификатор
7. **Сложность** — визуально показывается через маскота (например, красный и злой = сложно)
8. **Баллы** — представляют собой звёздочки
9. **Hints (подсказки)** — выводятся после неправильного ответа
10. **Линейная последовательность** — уровни открываются по порядку
11. **Требование для разблокировки** — нужно пройти ВСЕ задания минимум на 1 звезду, чтобы открыть следующий уровень

---

## Типы сцен (forma)

### 1. Теоретическая сцена (Theory)

```json
{
  "id": "level1_theory1",
  "forma": "theory",
  "template": "template1",
  "difficulty": "easy",
  "title": "Введение в профессию",
  "content": "Текст теории...",
  "image": "/assets/theory/image1.png",
  "mascotMood": "friendly"
}
```

**Вопросы для обсуждения:**
- Нужно ли "проходить" теорию или просто прочитать?
- Даёт ли теория звёзды или это просто информация перед заданиями?

---

### 2. Множественный выбор (MultiChoice)

```json
{
  "id": "level1_multi1",
  "forma": "multiChoice",
  "template": "template2",
  "difficulty": "medium",
  "question": "Какой инструмент используется для...?",
  "options": [
    { "id": "a", "text": "Вариант А" },
    { "id": "b", "text": "Вариант Б" },
    { "id": "c", "text": "Вариант В" },
    { "id": "d", "text": "Вариант Г" }
  ],
  "correctAnswer": "b",
  "maxStars": 3,
  "starCriteria": {
    "3stars": "С первой попытки",
    "2stars": "Со второй попытки",
    "1star": "С третьей попытки или с подсказкой"
  },
  "hints": [
    "Подсказка 1: Подумай о...",
    "Подсказка 2: Правильный ответ связан с..."
  ],
  "explanation": "Объяснение почему правильный ответ Б..."
}
```

**Вопросы для обсуждения:**
- Сколько попыток даём до подсказки?
- После скольких неправильных попыток показываем hint?

---

### 3. Правильный порядок (CorrectOrder)

```json
{
  "id": "level1_order1",
  "forma": "correctOrder",
  "template": "template1",
  "difficulty": "hard",
  "mascotMood": "angry",
  "question": "Расставь шаги в правильном порядке:",
  "items": [
    { "id": "step1", "text": "Шаг первый" },
    { "id": "step2", "text": "Шаг второй" },
    { "id": "step3", "text": "Шаг третий" },
    { "id": "step4", "text": "Шаг четвёртый" }
  ],
  "correctOrder": ["step2", "step1", "step4", "step3"],
  "maxStars": 3,
  "starCriteria": {
    "3stars": "Полностью правильный порядок с первой попытки",
    "2stars": "Правильно со второй попытки",
    "1star": "Правильно с подсказкой"
  },
  "hints": [
    "Сначала нужно сделать...",
    "После этого идёт шаг связанный с..."
  ]
}
```

**Вопросы для обсуждения:**
- Засчитывать частично правильный порядок? (например 2 из 4 правильно)
- Или только полностью правильный засчитывается?

---

### 4. Свой ответ (OwnAnswer + AI)

```json
{
  "id": "level1_own1",
  "forma": "ownAnswer",
  "template": "template3",
  "difficulty": "medium",
  "question": "Опиши своими словами как бы ты решил эту задачу...",
  "aiPrompt": "Оцени ответ студента по следующим критериям: 1) Полнота ответа 2) Правильность подхода 3) Ясность изложения. Верни количество звёзд (1-3) и краткую обратную связь.",
  "expectedKeyPoints": [
    "Должен упомянуть про...",
    "Должен учесть фактор...",
    "Важно отметить..."
  ],
  "maxStars": 3,
  "minLength": 50,
  "hints": [
    "Подумай о ключевых аспектах...",
    "Не забудь упомянуть про..."
  ]
}
```

**Вопросы для обсуждения:**
- AI будет оценивать через API в реальном времени?
- Можно ли пересдать этот тип задания?
- Показывать ли expectedKeyPoints пользователю после ответа?

---

## Общая структура уровня

```json
{
  "levelId": "level1",
  "levelName": "Основы профессии",
  "profession": "Developer",
  "unlockRequirement": "Пройди все задания минимум на 1 звезду",
  "totalStarsAvailable": 15,
  "scenes": [
    { /* theory scene */ },
    { /* multiChoice scene */ },
    { /* correctOrder scene */ },
    { /* ownAnswer scene */ }
  ]
}
```

---

## Система Templates

### Назначение:
Поле `template` определяет визуальное представление сцены:
- Расположение элементов (текст, заголовок, фото маскота)
- Цветовую палитру
- Шрифты и размеры
- Анимации появления

### Примеры templates:

**Template1:**
- Маскот слева, контент справа
- Цветовая палитра: синий + белый
- Шрифт: крупный заголовок, средний текст
- Анимация появления: fade-in

**Template2:**
- Маскот сверху по центру, контент снизу
- Цветовая палитра: фиолетовый + голубой
- Шрифт: средний заголовок, мелкий текст
- Анимация появления: slide-up

**Template3:**
- Маскот справа, контент слева
- Цветовая палитра: оранжевый + жёлтый
- Полноэкранный режим
- Анимация появления: zoom-in

### Концепция рендеринга:

```jsx
// Псевдокод концепции
const TEMPLATES = {
  template1: TheoryTemplate1Component,
  template2: MultiChoiceTemplate2Component,
  template3: OwnAnswerTemplate3Component,
};

scenes.map(scene => {
  const TemplateComponent = TEMPLATES[scene.template];
  return <TemplateComponent key={scene.id} data={scene} />;
});
```

---

## Открытые вопросы для дальнейшего обсуждения

### 1. Прогресс пользователя
- Где хранить прогресс? (отдельный объект userProgress?)
- Формат хранения (localStorage, база данных, API?)

### 2. Повтор заданий
- Можно ли улучшить результат? (было 1 звезда → пересдать на 3?)
- Ограничения на количество попыток?

### 3. Система подсказок (Hints)
- Показывать hints по очереди или сразу все после ошибки?
- Влияет ли использование hints на количество звёзд?

### 4. Таймер
- Будет ли время влиять на количество звёзд?
- Есть ли ограничение по времени на задание?

### 5. AI оценка (для OwnAnswer)
- Какой AI API использовать?
- Как обрабатывать ошибки API?
- Кэшировать ли оценки?

---

## Архитектура (три слоя)

### 1. Data Layer (Слой данных)
- JSON файлы или база данных с контентом
- Структурированная схема для каждого типа сцены
- Прогресс пользователя

### 2. Logic Layer (Слой логики)
- State management (управление состоянием)
- Логика прогрессии через уровни
- Валидация ответов
- AI оценка
- Подсчёт звёзд

### 3. Presentation Layer (Слой презентации)
- React компоненты для каждого типа сцены
- Template компоненты
- UI элементы (звёзды, маскот, подсказки)

---

## Следующие шаги

1. **Воскресенье:** Детальное обсуждение открытых вопросов
2. Финализация JSON схемы
3. Подготовка первого уровня с реальным контентом
4. Разработка компонентов
5. Интеграция AI для оценки свободных ответов
6. Система сохранения прогресса
7. Тестирование на реальных пользователях
